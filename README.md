## 简单漏扫工具

#### 0x00：工具简介

​		该漏扫工具通过**python+php+html**实现，其中主要功能均已**python**脚本实现。

​		工具功能简介：

1. 前端页面主要用于传参与结果展示
2. 获取开放端口
3. 子域名和后台暴破
4. 获取url概括信息
5. 采集url指纹信息
6. cve漏洞扫描
7. xss扫描
8. SQL暴破
9. 内网IP扫描
10. 智能扫描

#### 0x01：前端

![](ca2ecbdad365299869f6ca4dd303366.png)

#### 0x02：全局扫描

- 包含
  1. 获取开放端口
     - 通过**socket**探测
  2. 子域名和后台暴破
     - 借助**FOFA**的**api**接口调用获取结果
  3. 获取**url**的**IP**
     - 通过**url**直接提取或通过**socket**获取

![](8640ab0062d92a9463a1ecefda11769.png)

![](1b79716e570a85cbdda428b742e332a.png)

#### 0x03：指纹信息采集

- 包含
  1. 获取**url**概括信息
     - 通过**python**的**whois**模块调取信息
  2. 采集**url**指纹信息
     - 通过**Wappalyzer**外部api获取指纹信息

![](c2477b8dc3afb9275bc6c67829ae7fa.png)

![](99943bcd9aaae29f4290fad4ddc25e5.png)

#### 0x04：CVE漏洞扫描

- 通过漏洞特征，利用收发流量包的方式实现复现，获取特征确定漏洞。

  发包数据利用到了json文件，及一些硬编码python文件

![](63ce875bab4c812ba1d11539ab8a0dd.png)

#### 0x05：xss与sql

1. xss扫描
   - 利用get传参，输入固定payload，试探网页是否存在xss漏洞
2. SQL暴破
   - sql暴破利用sqlmap的api接口传参，获取返回结果提取payload值

![](6eeb247bdce56550be69cb02ad93b4d.png)

![](7f56a94d762d7a1e0d8f78df6f35ec6.png)

#### 0x06：内网IP扫描

- 利用python执行命令行，使用ping来获取内网存活IP

![](440f23aac3c9c9b81952899c24162ea.png)

#### 0x07：智能扫描

- 整合所有功能自动执行所有脚本，自动获取关联信息,自动根据指纹信息选取对应的CVE模块

![](a995c026db17af6adcdb7a56fc2d34d.png)

