import sys
sys.path.append('/opt/lampp/htdocs/Scan/')    #添加搜索路径

from cve.get_cve import get
from cve.Magento import mag
from cve.post_cve import post
from cve.SSI远程命令执行漏洞 import si
from cve.全局变量防御绕过 import bp


class st_wr:
    def __init__(self):
        with open('../opt/结果.txt','w') as fi:     #清空之前结果，之后让前端判断是否有内容在输出
            fi.write('')
        self.d = si()
        self.e = bp()
        self.b = mag()
        self.a = get()
        self.c = post()

    def write(self):
        with open('../opt/结果.txt','w') as f:
            f.write('CVE扫描结果:\n')
            f.write(f'{self.d}\n')
            f.write(f'{self.e}\n')
            f.write(f'{self.b}\n')
            if self.d ==None and self.e == None and self.b == None:
                f.write(f'{self.a}\n')
                f.write(f'{self.c}\n')




st_wr = st_wr()
st_wr.write()