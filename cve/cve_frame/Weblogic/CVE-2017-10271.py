import requests

class web:
    def __init__(self):   #读取指定文件
        with open('../opt/前端传url.txt','r') as file:
            self.url = file.readline()
        self.heards={
            "User-Agent": "Mozilla/5.0 (Windows NT 10.0; WOW64; rv:46.0) Gecko/20100101 Firefox/46.0",
            "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8",
        }

    # http://192.168.114.149:7001/wls-wsat/CoordinatorPortType
    def get_post(self):
        pay = ["/wls-wsat/CoordinatorPortType", "/wls-wsat/RegistrationPortTypeRPC", "/wls-wsat/ParticipantPortType","/wls-wsat/RegistrationRequesterPortType","/wls-wsat/CoordinatorPortType11","/wls-wsat/RegistrationPortTypeRPC11","/wls-wsat/ParticipantPortType11","/wls-wsat/RegistrationRequesterPortType11"]
        for p in pay:
            self.payload = self.url.strip("\n") + p
            # print(self.payload)
            response = requests.get(url=self.payload, headers=self.heards)
            res = response.text
            # print(res)
            if self.payload in res:
                a = f"可能存在CVE-2017-10271漏洞payload如下{self.payload}"
                print(a)
                return a


web = web()
web.get_post()